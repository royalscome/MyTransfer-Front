"use strict";require("crypto");const{app:o,BrowserWindow:s,protocol:l,ipcMain:a}=require("electron"),{join:n,resolve:h,dirname:v}=require("path");require("child_process");require("fs");l.registerSchemesAsPrivileged([{scheme:"app",privileges:{secure:!0,standard:!0}}]);process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";process.env.NODE_ENV===void 0&&(process.defaultApp?process.env.NODE_ENV="development":process.env.NODE_ENV="production");const d=process.env.NODE_ENV!=="production";let u,p="";global.sharedObject={url:p,name:"局域网文件互传系统",version:"1.0.0",exePath:u,environment:d?"development":"production",homePath:o.getPath("home")};a.on("get-shared-object",e=>{e.returnValue=global.sharedObject});const i=async()=>{const e=new s({icon:n(__dirname,"resource/favicon.ico"),title:"局域网文件互传",width:1024,height:768,show:!1,webPreferences:{webSecurity:!1,enableRemoteModule:!0,nodeIntegration:!0,contextIsolation:!1,webviewTag:!0}});e.on("ready-to-show",()=>{e.show(),e.maximize()});let t=!1;e.on("close",r=>{t||(r.preventDefault(),e.webContents.send("confirm-close"))}),a.on("can-close",()=>{t||(t=!0,e.close())}),e.on("closed",()=>{o.quit()}),process.env.VITE_DEV_SERVER_URL?(await e.loadURL(process.env.VITE_DEV_SERVER_URL).catch(r=>{console.error("Failed to load URL:",r)}),process.env.IS_TEST||e.webContents.openDevTools()):e.loadFile(n(__dirname,"dist/index.html"))};o.commandLine.appendSwitch("--ignore-certificate-errors","true");o.on("certificate-error",(e,t,r,f,w,c)=>{e.preventDefault(),c(!0)});o.whenReady().then(()=>{i(),o.on("activate",()=>{s.getAllWindows().length===0&&i()})});o.on("window-all-closed",()=>{process.platform!=="darwin"&&o.quit()});
